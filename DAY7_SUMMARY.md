# Day 7-8: Correction System - COMPLETED ‚úÖ

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. Correction Handler (handlers/corrections.py)
- ‚úÖ `handle_correction_text()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ü–∏–π
- ‚úÖ `show_correction_help()` - –ø–æ–º–æ—â—å –ø–æ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è–º
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π (MAX_CORRECTIONS = 3)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π —á–µ—Ä–µ–∑ CorrectionParser
- ‚úÖ –ü–µ—Ä–µ—Å—á—ë—Ç –∏—Ç–æ–≥–æ–≤ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ –°—á—ë—Ç—á–∏–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

### 2. Session Manager Updates (core/session_manager.py)
- ‚úÖ `get_current_analysis()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ `save_correction()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π –≤ —Å–µ—Å—Å–∏–∏
- ‚úÖ –°—á—ë—Ç—á–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π –≤ —Å–µ—Å—Å–∏–∏

### 3. Config Updates (config.py)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ `correction_error`
- ‚úÖ MAX_CORRECTIONS —É–∂–µ –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω (3)

### 4. Formatters Update (utils/formatters.py)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `correction_error` –≤ `format_error()`

### 5. Main Bot Integration (main_new.py)
- ‚úÖ –ò–º–ø–æ—Ä—Ç `handle_correction_text`
- ‚úÖ –†–æ—É—Ç–∏–Ω–≥ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ WAITING_CORRECTION
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º flow

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Correction System

### Flow –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –∞–Ω–∞–ª–∏–∑
   ‚Üì
2. –ù–∞–∂–∏–º–∞–µ—Ç "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º"
   ‚Üì
3. –°–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí WAITING_CORRECTION
   ‚Üì
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏—é
   ‚Üì
5. CorrectionParser –ø–∞—Ä—Å–∏—Ç —Ç–µ–∫—Å—Ç
   ‚Üì
6. –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è (remove/add/modify)
   ‚Üì
7. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏—Ç–æ–≥–∏
   ‚Üì
8. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–µ—Å—Å–∏—é
   ‚Üì
9. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑
   ‚Üì
10. –°–æ—Å—Ç–æ—è–Ω–∏–µ ‚Üí WAITING_CONFIRMATION
```

### –¢–∏–ø—ã –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

#### 1. Remove (–£–±—Ä–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
```
–ü—Ä–∏–º–µ—Ä—ã:
‚Ä¢ "–Ω–µ—Ç —Ö–ª–µ–±–∞"
‚Ä¢ "—É–±–µ—Ä–∏ —Å–∞–ª–∞—Ç"
‚Ä¢ "–±–µ–∑ —Å–æ—É—Å–∞"

–î–µ–π—Å—Ç–≤–∏–µ:
- –ù–∞—Ö–æ–¥–∏—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ –∏–º–µ–Ω–∏
- –£–¥–∞–ª—è–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–∏
```

#### 2. Add (–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
```
–ü—Ä–∏–º–µ—Ä—ã:
‚Ä¢ "–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥"
‚Ä¢ "–µ—Å—Ç—å –µ—â—ë —Ö–ª–µ–± 50–≥"
‚Ä¢ "–ø–ª—é—Å –æ–≥—É—Ä–µ—Ü"

–î–µ–π—Å—Ç–≤–∏–µ:
- –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –û—Ü–µ–Ω–∏–≤–∞–µ—Ç –∫–∞–ª–æ—Ä–∏–∏ (~200 –∫–∫–∞–ª/100–≥)
- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ë–ñ–£
- –î–æ–±–∞–≤–ª—è–µ—Ç –≤ —Å–ø–∏—Å–æ–∫
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–∏
```

#### 3. Modify (–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
```
–ü—Ä–∏–º–µ—Ä—ã:
‚Ä¢ "—ç—Ç–æ –∫—É—Ä–∏—Ü–∞, –∞ –Ω–µ —Å–≤–∏–Ω–∏–Ω–∞"
‚Ä¢ "–Ω–µ –≥–æ–≤—è–¥–∏–Ω–∞, –∞ –∏–Ω–¥–µ–π–∫–∞"

–î–µ–π—Å—Ç–≤–∏–µ:
- –ù–∞—Ö–æ–¥–∏—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –ú–µ–Ω—è–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å –∏ –∫–∞–ª–æ—Ä–∏–∏
- –°–Ω–∏–∂–∞–µ—Ç confidence –¥–æ 0.7
```

### –õ–∏–º–∏—Ç—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

```python
MAX_CORRECTIONS = 3  # –ú–∞–∫—Å–∏–º—É–º 3 –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –Ω–∞ —Å–µ—Å—Å–∏—é

–ü—Ä–æ–≤–µ—Ä–∫–∏:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ WAITING_CORRECTION
2. –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è
3. –ù–µ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏–π
4. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –≤–∞–ª–∏–¥–Ω–∞ (CorrectionValidator)
5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω (–¥–ª—è remove/modify)
```

### –ü–µ—Ä–µ—Å—á—ë—Ç –∏—Ç–æ–≥–æ–≤

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è:
- ‚öñÔ∏è –û–±—â–∏–π –≤–µ—Å
- üî• –û–±—â–∏–µ –∫–∞–ª–æ—Ä–∏–∏
- ü•ö –û–±—â–∏–µ –±–µ–ª–∫–∏
- ü•ë –û–±—â–∏–µ –∂–∏—Ä—ã
- üåæ –û–±—â–∏–µ —É–≥–ª–µ–≤–æ–¥—ã
- üìä –ö–∞–ª–æ—Ä–∏–∏ –Ω–∞ 100–≥
- ‚≠ê Health score (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª—Å—è —Å–æ—Å—Ç–∞–≤)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –£–±—Ä–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–Ω–µ—Ç —Ö–ª–µ–±–∞"

–†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞! (–û—Å—Ç–∞–ª–æ—Å—å: 2)

üîç –ê–Ω–∞–ª–∏–∑ —Ñ–æ—Ç–æ
üçΩÔ∏è –ü–µ–ª—å–º–µ–Ω–∏ —Å–æ —Å–º–µ—Ç–∞–Ω–æ–π

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. ‚úÖ –ü–µ–ª—å–º–µ–Ω–∏
   üìä –í–µ—Å: ~250–≥
   üî• –ö–∞–ª–æ—Ä–∏–∏: ~625 –∫–∫–∞–ª
   ...

2. ‚úÖ –°–º–µ—Ç–∞–Ω–∞
   üìä –í–µ—Å: ~30–≥
   üî• –ö–∞–ª–æ—Ä–∏–∏: ~60 –∫–∫–∞–ª
   ...

[–•–ª–µ–± —É–¥–∞–ª—ë–Ω]

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìä –ò—Ç–æ–≥–æ:
‚öñÔ∏è –í–µ—Å: 280–≥
üî• –ö–∞–ª–æ—Ä–∏–∏: 685 –∫–∫–∞–ª
...
```

### –ü—Ä–∏–º–µ—Ä 2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥"

–†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞! (–û—Å—Ç–∞–ª–æ—Å—å: 2)

[–î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç]

3. ‚úÖ –°–∞–ª–∞—Ç
   üìä –í–µ—Å: ~100–≥
   üî• –ö–∞–ª–æ—Ä–∏–∏: ~200 –∫–∫–∞–ª
   ü•ö –ë: 8–≥ | ü•ë –ñ: 7–≥ | üåæ –£: 28–≥
   üí≠ –Ω–µ —É–≤–µ—Ä–µ–Ω (50%)

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìä –ò—Ç–æ–≥–æ:
‚öñÔ∏è –í–µ—Å: 380–≥
üî• –ö–∞–ª–æ—Ä–∏–∏: 885 –∫–∫–∞–ª
...
```

### –ü—Ä–∏–º–µ—Ä 3: –ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "—ç—Ç–æ –∫—É—Ä–∏—Ü–∞, –∞ –Ω–µ —Å–≤–∏–Ω–∏–Ω–∞"

–†–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∞! (–û—Å—Ç–∞–ª–æ—Å—å: 2)

1. ‚úÖ –ö—É—Ä–∏—Ü–∞  [–±—ã–ª–æ: –°–≤–∏–Ω–∏–Ω–∞]
   üìä –í–µ—Å: ~250–≥
   üî• –ö–∞–ª–æ—Ä–∏–∏: ~625 –∫–∫–∞–ª
   ...
   üí≠ –≤–µ—Ä–æ—è—Ç–Ω–æ (70%)  [confidence —Å–Ω–∏–∂–µ–Ω]
```

### –ü—Ä–∏–º–µ—Ä 4: –õ–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

```
–ü–æ—Å–ª–µ 3 –∫–æ—Ä—Ä–µ–∫—Ü–∏–π:

‚ö†Ô∏è –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏–π (3).

–¢—ã –º–æ–∂–µ—à—å:
‚Ä¢ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∞–Ω–∞–ª–∏–∑
‚Ä¢ –û—Ç–º–µ–Ω–∏—Ç—å –∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å /cancel
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
```
‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ü–∏—é

–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã.

–ü—Ä–∏–º–µ—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ü–∏–π:
...
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
```
‚ùå –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: "—Ö–ª–µ–±"

–ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã.
```

### –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
```
‚ùå –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
```

### –ù–µ–≤–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```
‚ö†Ô∏è –°–µ–π—á–∞—Å –Ω–µ –æ–∂–∏–¥–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º flow

### Callbacks Integration

–ö–Ω–æ–ø–∫–∞ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º" –≤ `handlers/callbacks.py`:

```python
async def handle_edit_callback(...):
    if item == "text":
        # Switch to correction mode
        await state_manager.set_state(user_id, UserState.WAITING_CORRECTION)
        
        await query.edit_message_text(
            "‚úèÔ∏è **–†–µ–∂–∏–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**\n\n"
            "–ù–∞–ø–∏—à–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:\n\n"
            "–ü—Ä–∏–º–µ—Ä—ã:\n"
            "‚Ä¢ \"–Ω–µ—Ç —Ö–ª–µ–±–∞\" - —É–±—Ä–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç\n"
            "‚Ä¢ \"–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥\" - –¥–æ–±–∞–≤–∏—Ç—å\n"
            "‚Ä¢ \"—ç—Ç–æ –∫—É—Ä–∏—Ü–∞, –∞ –Ω–µ —Å–≤–∏–Ω–∏–Ω–∞\" - –∏–∑–º–µ–Ω–∏—Ç—å\n\n"
            "–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π /cancel –¥–ª—è –æ—Ç–º–µ–Ω—ã.",
            parse_mode=ParseMode.MARKDOWN
        )
```

### State Transitions

```
WAITING_CONFIRMATION
    ‚Üì (–Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º")
WAITING_CORRECTION
    ‚Üì (–≤–≤–µ–¥–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è)
WAITING_CONFIRMATION
    ‚Üì (–Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞ "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å")
IDLE
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### CorrectionParser

–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –Ω–∞ Day 4, —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω:

```python
parser = CorrectionParser()
success, updated_analysis, error_message = parser.parse_correction(
    correction_text,
    current_analysis
)
```

### Session Data Structure

```python
{
    'session_id': 'session_abc123',
    'user_id': 12345,
    'photo_file_id': 'AgACAgIAAxkBAAI...',
    'initial_analysis': {...},
    'corrected_analysis': {...},  # –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
    'corrections': [
        {
            'text': '–Ω–µ—Ç —Ö–ª–µ–±–∞',
            'timestamp': '2026-01-20T04:15:00'
        },
        {
            'text': '–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥',
            'timestamp': '2026-01-20T04:16:00'
        }
    ],
    'correction_count': 2,
    'status': 'pending'
}
```

### Validators

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ `utils/validators.py` (Day 4):

```python
CorrectionValidator:
- validate_correction(text) - –±–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
- detect_correction_type(text) - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞
- validate_weight(weight) - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ—Å–∞
- validate_component_name(name) - –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏
```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 1 (handlers/corrections.py)
- **–§–∞–π–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:** 4
  - core/session_manager.py
  - config.py
  - utils/formatters.py
  - main_new.py
- **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~200
- **–§—É–Ω–∫—Ü–∏–π:** 3 (handle_correction_text, show_correction_help, + updates)
- **–¢–∏–ø–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π:** 3 (remove, add, modify)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í Telegram

1. **–û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –µ–¥—ã**
   ```
   ‚Üí –ü–æ–ª—É—á–∏—à—å –∞–Ω–∞–ª–∏–∑ —Å –∫–Ω–æ–ø–∫–∞–º–∏
   ```

2. **–ù–∞–∂–º–∏ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º"**
   ```
   ‚Üí –ü–µ—Ä–µ–π–¥—ë—à—å –≤ —Ä–µ–∂–∏–º –∫–æ—Ä—Ä–µ–∫—Ü–∏–π
   ‚Üí –£–≤–∏–¥–∏—à—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã
   ```

3. **–ù–∞–ø–∏—à–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏—é**
   ```
   –ü—Ä–∏–º–µ—Ä—ã:
   ‚Ä¢ "–Ω–µ—Ç —Ö–ª–µ–±–∞"
   ‚Ä¢ "–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥"
   ‚Ä¢ "—ç—Ç–æ –∫—É—Ä–∏—Ü–∞, –∞ –Ω–µ —Å–≤–∏–Ω–∏–Ω–∞"
   ```

4. **–ü–æ–ª—É—á–∏ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑**
   ```
   ‚Üí –£–≤–∏–¥–∏—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
   ‚Üí –°—á—ë—Ç—á–∏–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–π
   ‚Üí –ö–Ω–æ–ø–∫–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π
   ```

5. **–ü–æ–≤—Ç–æ—Ä–∏ –∏–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏**
   ```
   ‚Üí –ú–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å –µ—â—ë 2 –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
   ‚Üí –ò–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∞–Ω–∞–ª–∏–∑
   ‚Üí –ò–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å —Å /cancel
   ```

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –£—Å–ø–µ—à–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è
```
1. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ –ø–µ–ª—å–º–µ–Ω–µ–π
2. –ù–∞–∂–º–∏ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º"
3. –ù–∞–ø–∏—à–∏ "–Ω–µ—Ç —Ö–ª–µ–±–∞"
4. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Ö–ª–µ–± —É–¥–∞–ª—ë–Ω
5. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –∏—Ç–æ–≥–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã
6. –ü—Ä–æ–≤–µ—Ä—å —Å—á—ë—Ç—á–∏–∫ (–û—Å—Ç–∞–ª–æ—Å—å: 2)
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
```
1. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ
2. –°–¥–µ–ª–∞–π –∫–æ—Ä—Ä–µ–∫—Ü–∏—é 1: "–Ω–µ—Ç —Ö–ª–µ–±–∞"
3. –°–¥–µ–ª–∞–π –∫–æ—Ä—Ä–µ–∫—Ü–∏—é 2: "–¥–æ–±–∞–≤—å —Å–∞–ª–∞—Ç 100–≥"
4. –°–¥–µ–ª–∞–π –∫–æ—Ä—Ä–µ–∫—Ü–∏—é 3: "—ç—Ç–æ –∫—É—Ä–∏—Ü–∞, –∞ –Ω–µ —Å–≤–∏–Ω–∏–Ω–∞"
5. –ü–æ–ø—Ä–æ–±—É–π 4-—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é
6. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏–º–∏—Ç
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–µ–≤–µ—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è
```
1. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ
2. –ù–∞–∂–º–∏ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º"
3. –ù–∞–ø–∏—à–∏ "asdfghjkl"
4. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
5. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã
6. –ü–æ–ø—Ä–æ–±—É–π –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é
```

#### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –û—Ç–º–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
```
1. –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ
2. –ù–∞–∂–º–∏ "‚úèÔ∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–º"
3. –ò—Å–ø–æ–ª—å–∑—É–π /cancel
4. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–µ—Å—Å–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞
5. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–±—Ä–æ—à–µ–Ω–æ
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Day 9)

### Final Analysis & Save
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ meal –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–µ–π
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Day 9
- ‚úÖ Correction system —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –ò—Ç–æ–≥–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" –≥–æ—Ç–æ–≤–∞
- ‚è≥ –ù—É–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –æ—Ç–ª–∏—á–Ω–æ!
- ‚úÖ –õ–∏–º–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç!
- ‚úÖ –ü–µ—Ä–µ—Å—á—ë—Ç –∏—Ç–æ–≥–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç!
- ‚ö†Ô∏è –û—Ü–µ–Ω–∫–∞ –∫–∞–ª–æ—Ä–∏–π –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è (200 –∫–∫–∞–ª/100–≥)
  - –ë—É–¥–µ—Ç —É–ª—É—á—à–µ–Ω–æ –ø–æ–∑–∂–µ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- üöß –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ - –∑–∞–≥–ª—É—à–∫–∞ (Day 9)
- üöß –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î - Day 9

## –§–∞–π–ª—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞ Day 7-8
- `handlers/corrections.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ
- `core/session_manager.py` - –º–µ—Ç–æ–¥—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–π
- `config.py` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
- `utils/formatters.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
- `main_new.py` - —Ä–æ—É—Ç–∏–Ω–≥ –∫–æ—Ä—Ä–µ–∫—Ü–∏–π

### –ò–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–Ω–µ–π
- Day 1: core/*
- Day 2: handlers/commands.py, handlers/registration.py
- Day 3: utils/keyboards.py, handlers/callbacks.py
- Day 4: utils/validators.py, modules/nutrition/correction_parser.py
- Day 5: modules/nutrition/photo_analyzer.py
- Day 6: utils/display_helpers.py, utils/formatters.py

## –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

Day 7-8 ‚úÖ - Correction System –∑–∞–≤–µ—Ä—à—ë–Ω!

**–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç (Process ID: 13)** —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–π!

## –ü—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –ø–ª–∞–Ω—É (2 –Ω–µ–¥–µ–ª–∏)

**–ù–µ–¥–µ–ª—è 1 (DONE):**
- ‚úÖ Day 1-5: Infrastructure, User Management, Handlers, Validators, API

**–ù–µ–¥–µ–ª—è 2:**
- ‚úÖ Day 6: Preliminary Analysis Display ‚úÖ
- ‚úÖ Day 7-8: Correction System ‚úÖ
- ‚è≥ Day 9: Final Analysis & Save - NEXT!
- ‚è≥ Day 10-14: Testing & Polish

**–ü—Ä–æ–≥—Ä–µ—Å—Å: 8/14 –¥–Ω–µ–π (57.1%)**

üéâ **Correction System –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω!** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–æ–º —Å –ª–∏–º–∏—Ç–æ–º 3 –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏!
